
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../tutorials/">
      
      
        <link rel="next" href="../environment/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Expression - Qadence 2 expressions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/colors.css">
    
      <link rel="stylesheet" href="../../extras/css/home.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-expression-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Qadence 2 expressions" class="md-header__button md-logo" aria-label="Qadence 2 expressions" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qadence 2 expressions
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Expression
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/qadence2-expressions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence2_expressions
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/installation/" class="md-tabs__link">
          
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contents/expression_system/" class="md-tabs__link">
          
  
    
  
  Contents

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorials/" class="md-tabs__link">
        
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Qadence 2 expressions" class="md-nav__button md-logo" aria-label="Qadence 2 expressions" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Qadence 2 expressions
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/qadence2-expressions" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence2_expressions
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development & Info
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Development & Info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of conduct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contents
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/expression_system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expression system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/ir_compilation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IR compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/useful_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Expression
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Expression
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression" class="md-nav__link">
    <span class="md-ellipsis">
      Expression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.dag" class="md-nav__link">
    <span class="md-ellipsis">
      dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.max_index" class="md-nav__link">
    <span class="md-ellipsis">
      max_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.subspace" class="md-nav__link">
    <span class="md-ellipsis">
      subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.Tag" class="md-nav__link">
    <span class="md-ellipsis">
      Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.__pow__" class="md-nav__link">
    <span class="md-ellipsis">
      __pow__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.as_quantum_operator" class="md-nav__link">
    <span class="md-ellipsis">
      as_quantum_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.function" class="md-nav__link">
    <span class="md-ellipsis">
      function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.get" class="md-nav__link">
    <span class="md-ellipsis">
      get
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.kron" class="md-nav__link">
    <span class="md-ellipsis">
      kron
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.mul" class="md-nav__link">
    <span class="md-ellipsis">
      mul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.one" class="md-nav__link">
    <span class="md-ellipsis">
      one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.pow" class="md-nav__link">
    <span class="md-ellipsis">
      pow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.quantum_operator" class="md-nav__link">
    <span class="md-ellipsis">
      quantum_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.symbol" class="md-nav__link">
    <span class="md-ellipsis">
      symbol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.value" class="md-nav__link">
    <span class="md-ellipsis">
      value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.zero" class="md-nav__link">
    <span class="md-ellipsis">
      zero
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kron" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronjoin" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronjoin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronleft" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronleft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronop" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronright" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronright
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_expression" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_expression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_with_brackets" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_with_brackets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constructors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression" class="md-nav__link">
    <span class="md-ellipsis">
      Expression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.dag" class="md-nav__link">
    <span class="md-ellipsis">
      dag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.max_index" class="md-nav__link">
    <span class="md-ellipsis">
      max_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.subspace" class="md-nav__link">
    <span class="md-ellipsis">
      subspace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.Tag" class="md-nav__link">
    <span class="md-ellipsis">
      Tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.__pow__" class="md-nav__link">
    <span class="md-ellipsis">
      __pow__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.add" class="md-nav__link">
    <span class="md-ellipsis">
      add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.as_quantum_operator" class="md-nav__link">
    <span class="md-ellipsis">
      as_quantum_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.function" class="md-nav__link">
    <span class="md-ellipsis">
      function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.get" class="md-nav__link">
    <span class="md-ellipsis">
      get
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.kron" class="md-nav__link">
    <span class="md-ellipsis">
      kron
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.mul" class="md-nav__link">
    <span class="md-ellipsis">
      mul
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.one" class="md-nav__link">
    <span class="md-ellipsis">
      one
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.pow" class="md-nav__link">
    <span class="md-ellipsis">
      pow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.quantum_operator" class="md-nav__link">
    <span class="md-ellipsis">
      quantum_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.symbol" class="md-nav__link">
    <span class="md-ellipsis">
      symbol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.value" class="md-nav__link">
    <span class="md-ellipsis">
      value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.Expression.zero" class="md-nav__link">
    <span class="md-ellipsis">
      zero
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kron" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kron
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronjoin" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronjoin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronleft" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronleft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronop" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.evaluate_kronright" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_kronright
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_expression" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_expression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence2_expressions.core.expression.visualize_with_brackets" class="md-nav__link">
    <span class="md-ellipsis">
      visualize_with_brackets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/pasqal-io/qadence2-expressions/edit/master/docs/api/expressions.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/pasqal-io/qadence2-expressions/raw/master/docs/api/expressions.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="the-expression-module">The <code>expression</code> module</h1>
<p>The <code>expression</code> module defines an <code>Expression</code> type as a symbolic representation for mathematical expressions together with arithmetic rules. It is syntactically constructed using <a href="https://en.wikipedia.org/wiki/S-expression">S-Expressions</a> in prefix notation where the ordered parameters are:</p>
<ul>
<li>A tag as a Python <code>Enum</code>: a token identifier for variables, functions or operations.</li>
<li>Arguments: a set of arguments to define or be passed to the expression.</li>
<li>Attributes: keyword arguments for symbolic evaluation and compilation directives.</li>
</ul>
<p>The <code>Expression</code> type defines constructors for four identifiers and operations variants:</p>
<ul>
<li><code>VALUE</code>: A value type to hold numerical <code>complex</code>, <code>float</code> or <code>int</code> primitive types.</li>
<li><code>SYMBOL</code>: A symbol type for names definition.</li>
<li><code>FN</code>: A variadic function type defined as a symbolic name and arguments.</li>
<li><code>QUANTUM_OP</code>: A quantum operator type defined as an expression, a support of qubit resources and a collection of property attributes.</li>
<li><code>ADD</code>: A variadic addition type as the sum of arguments.</li>
<li><code>MUL</code>: A variadic multiplication type as the product of arguments.</li>
<li><code>KRON</code>: A variadic multiplication type as the product of arguments with commutative rules.</li>
<li><code>POW</code>: A power type as the exponentiation of a base and power arguments.</li>
</ul>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence2_expressions.core.expression.Expression" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Expression</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>A symbolic representation of mathematical expressions.</p>
<p>Besides arithmetic operations, the expression can contain classical functions such as sine,
cosine, and logarithm, and abstract representations of quantum operators.</p>
<p>Multiplication between quantum operators is stored as Kronecker products. Operators are ordered
by qubit index, preserving the order when the qubit indices of two operators overlap. This
ensures that operators acting on the same subspace are kept together, enhancing optimisation.</p>






                  <details class="quote">
                    <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="n">Expression</span><span class="o">.</span><span class="n">Tag</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">head</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attributes</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence2_expressions.core.expression.Expression.dag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dag</span><span class="p">:</span> <span class="n">Expression</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the conjugated/dagger version of and expression.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence2_expressions.core.expression.Expression.max_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_index</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the maximum qubit index present in the expression. An expression without quantum
operators or covering all the qubits will return -1.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>&gt;&gt;&gt; value(2).max_index
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>-1
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>&gt;&gt;&gt; (X() * Y(1)).max_index
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>-1
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>&gt;&gt;&gt; (X(0, 2) * Y(1)).max_index
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>2
</code></pre></div></p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence2_expressions.core.expression.Expression.subspace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">subspace</span><span class="p">:</span> <span class="n">Support</span> <span class="o">|</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the total subspace coverage of an expression with quantum operators. If there are
no quantum operators, the subspace is None. If controlled operators are present, it returns
a controlled support if there is no overlap between targets and controls; otherwise, all
indices are treated as targets.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">subspace</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kc">None</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">subspace</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">control</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">subspace</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="o">|</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">control</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">subspace</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div></p>
    </div>

</div>


<div class="doc doc-object doc-class">



<h4 id="qadence2_expressions.core.expression.Expression.Tag" class="doc doc-heading">
            <code>Tag</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>This auxiliar class allows the <code>Expression</code> to be represented as a tagged union.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Makes the arguments of the expression directly accessible through <code>expression[i]</code>.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes the arguments of the expression directly accessible through `expression[i]`.&quot;&quot;&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.__pow__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__pow__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Power involving quantum operators always promote expression to quantum operators.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Power involving quantum operators always promote expression to quantum operators.&quot;&quot;&quot;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Expression</span> <span class="o">|</span> <span class="n">Numeric</span><span class="p">):</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Numeric</span><span class="p">):</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">return</span> <span class="bp">self</span> <span class="o">**</span> <span class="n">Expression</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="c1"># Numerical values are computed right away.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_value</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">is_value</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="c1"># Null power shortcut.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="c1"># Identity power shortcut.</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">is_one</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="c1"># Power of power is a simple operation and can be evaluated here.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_quantum_operator</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_hermitian&quot;</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_unitary&quot;</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Expression</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">is_value</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="ow">and</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="p">):</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">power</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">%</span> <span class="mi">2</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">power</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">Expression</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="c1"># Power of power is an simple operation and can be evaluated here.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="c1"># Whenever a quantum operator is present, the expression is promoted to</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="c1"># a quantum operator.</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_power</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">as_quantum_operator</span><span class="p">()</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">as_quantum_operator</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>In Expressions, addition is a variadic operation representing the sum of its arguments.</p>
<p>Expression.add(a, b, c) == a + b + c</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;In Expressions, addition is a variadic operation representing the sum of its arguments.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    Expression.add(a, b, c) == a + b + c</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.as_quantum_operator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_quantum_operator</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Promotes and expression to a quantum operator.</p>
<p>When a function takes a quantum operator as input, the function itself must be transformed
into a quantum operator to preserve commutation properties. For instance,</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>&gt;&gt;&gt; exp(2) * exp(3)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>exp(5)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>&gt;&gt;&gt; exp(X(1)) * exp(Y(1))
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>exp(X(1)) exp(Y(1))
</code></pre></div></p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="k">def</span> <span class="nf">as_quantum_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Promotes and expression to a quantum operator.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    When a function takes a quantum operator as input, the function itself must be transformed</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    into a quantum operator to preserve commutation properties. For instance,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    ```</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    &gt;&gt;&gt; exp(2) * exp(3)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    exp(5)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    &gt;&gt;&gt; exp(X(1)) * exp(Y(1))</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    exp(X(1)) exp(Y(1))</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    ```</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">subspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">if</span> <span class="n">subspace</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">quantum_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subspace</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">function</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Symbolic representation of a function. The <code>name</code> indicates the function identifier, the
remaining arguments are used as the function arguments.</p>
<div class="highlight"><pre><span></span><code>Expression.function(&quot;sin&quot;, 1.57) =&gt; sin(1.57)
</code></pre></div>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The function name.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The arguments to be passed to the function.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A <code>Function(Symbol('name'), args...)</code> expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Symbolic representation of a function. The `name` indicates the function identifier, the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    remaining arguments are used as the function arguments.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Expression.function(&quot;sin&quot;, 1.57) =&gt; sin(1.57)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        name: The function name.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        args: The arguments to be passed to the function.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        A `Function(Symbol(&#39;name&#39;), args...)` expression.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">FN</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieve the value of the chosen <code>attribute</code> if it exists, or return the <code>default</code> value
if it doesn't.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the value of the chosen `attribute` if it exists, or return the `default` value</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    if it doesn&#39;t.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.kron" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>In Expressions, the Kronecker product is a variadic operation representing the
multiplication of its arguments applying commutative rules. When the qubit indices of two
operators overlap, the order is preserved. Otherwise, the operators are ordered by index,
with operators acting on the same qubits placed next to each other.</p>
<div class="highlight"><pre><span></span><code>Expression.kron(X(1), X(2), Y(1)) == X(1)Y(1) ⊗  X(2)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="k">def</span> <span class="nf">kron</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;In Expressions, the Kronecker product is a variadic operation representing the</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    multiplication of its arguments applying commutative rules. When the qubit indices of two</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    operators overlap, the order is preserved. Otherwise, the operators are ordered by index,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    with operators acting on the same qubits placed next to each other.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Expression.kron(X(1), X(2), Y(1)) == X(1)Y(1) ⊗  X(2)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">KRON</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.mul" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mul</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>In Expressions, multiplication is a variadic operation representing the product of its
arguments.</p>
<div class="highlight"><pre><span></span><code>Expression.mul(a, b, c) == a * b * c
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;In Expressions, multiplication is a variadic operation representing the product of its</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    arguments.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        Expression.mul(a, b, c) == a * b * c</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">MUL</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.one" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">one</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Used to represent both, the numerical value <code>1</code> and the identity operator.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An <code>Value(1)</code> expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="k">def</span> <span class="nf">one</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to represent both, the numerical value `1` and the identity operator.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        An `Value(1)` expression.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.pow" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">pow</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Define a power expression.</p>
<p>Expression.power(a, b) == a**b</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="k">def</span> <span class="nf">pow</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">power</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Define a power expression.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    Expression.power(a, b) == a**b</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">POW</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.quantum_operator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">quantum_operator</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">support</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>To turn an expression into a quantum operator, specify the support it acts on. Attributes
like <code>is_projector</code> [bool], <code>is_hermitian</code> [bool], <code>is_unitary</code> [bool], <code>is_dagger</code> [bool],
and <code>join</code> [callable] indicate how the operator behaves during evaluation.</p>
<p>A parametric quantum operator is a function wrapped in a quantum operator. The <code>join</code>
attribute is used to combine the arguments of two parametric operators.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expr</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>An expression that describes the operator. If <code>expr</code> is a symbol, it represents
a generic gate like Pauli and Clifford gates. If <code>expr</code> is a function, it represents
a parametric operator. Power expressions can be used to represent unitary evolution
operators.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>support</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The qubit indices to what the operator is applied.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.support.Support" href="../support/#qadence2_expressions.core.support.Support">Support</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>Keyword arguments are used primarily to symbolic evaluation. Examples of keywords are:
    - <code>is_projector</code> [bool]
    - <code>is_hermitian</code> [bool]
    - <code>is_unitary</code> [bool]
    - <code>is_dagger</code> [bool]
    - <code>join</code> [callable]</p>
<p>The keyword, <code>join</code> is used with parametric operators. Whe two parametric operator of
the same kind action on the same subspace are muliplied, the <code>join</code> is used to combine
their arguments.</p>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An expression of type <code>QuantumOperator</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span> <span class="nf">quantum_operator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">support</span><span class="p">:</span> <span class="n">Support</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;To turn an expression into a quantum operator, specify the support it acts on. Attributes</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    like `is_projector` [bool], `is_hermitian` [bool], `is_unitary` [bool], `is_dagger` [bool],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    and `join` [callable] indicate how the operator behaves during evaluation.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    A parametric quantum operator is a function wrapped in a quantum operator. The `join`</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    attribute is used to combine the arguments of two parametric operators.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        expr: An expression that describes the operator. If `expr` is a symbol, it represents</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            a generic gate like Pauli and Clifford gates. If `expr` is a function, it represents</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            a parametric operator. Power expressions can be used to represent unitary evolution</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            operators.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        support: The qubit indices to what the operator is applied.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Keyword arguments are used primarily to symbolic evaluation. Examples of keywords are:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            - `is_projector` [bool]</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            - `is_hermitian` [bool]</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            - `is_unitary` [bool]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            - `is_dagger` [bool]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            - `join` [callable]</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        The keyword, `join` is used with parametric operators. Whe two parametric operator of</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        the same kind action on the same subspace are muliplied, the `join` is used to combine</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        their arguments.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        An expression of type `QuantumOperator`.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">QUANTUM_OP</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">support</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.symbol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">symbol</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create a symbol from the identifier.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifier</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A string used as the symbol name.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>Keyword arguments are used as flags for compilation steps.
The valid flags are defined in Qadence2-IR.</p>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A <code>Symbol('identifier')</code> expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a symbol from the identifier.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        identifier: A string used as the symbol name.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        Keyword arguments are used as flags for compilation steps.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        The valid flags are defined in Qadence2-IR.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        A `Symbol(&#39;identifier&#39;)` expression.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">SYMBOL</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="o">**</span><span class="n">attributes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">value</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Promote a numerical value (complex, float, int) to an expression.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A numerical value.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence2_expressions.core.utils.Numeric">Numeric</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A <code>Value(x)</code> expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Numeric</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Promote a numerical value (complex, float, int) to an expression.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        x: A numerical value.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        A `Value(x)` expression.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">VALUE</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">VALUE</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence2_expressions.core.expression.Expression.zero" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zero</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Used to represent both, the numerical value <code>0</code> and the null operator.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="qadence2_expressions.core.expression.Expression" href="#qadence2_expressions.core.expression.Expression">Expression</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An <code>Value(0)</code> expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to represent both, the numerical value `0` and the null operator.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        An `Value(0)` expression.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.evaluate_kron" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_kron</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate Kronecker product expressions.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="k">def</span> <span class="nf">evaluate_kron</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate Kronecker product expressions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="n">lhs</span> <span class="o">=</span> <span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>    <span class="k">for</span> <span class="n">rhs</span> <span class="ow">in</span> <span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="c1"># Single operators multiplication, A ⊗ B</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">is_quantum_operator</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_quantum_operator</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">lhs</span> <span class="o">=</span> <span class="n">evaluate_kronop</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="c1"># Left associativity, A ⊗ (B ⊗ C ⊗ D) = (A ⊗ B ⊗ C ⊗ D)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="k">elif</span> <span class="n">lhs</span><span class="o">.</span><span class="n">is_quantum_operator</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">lhs</span> <span class="o">=</span> <span class="n">evaluate_kronleft</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="c1"># Right associativity, (A ⊗ B ⊗ C) ⊗ D = (A ⊗ B ⊗ C ⊗ D)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">elif</span> <span class="n">lhs</span><span class="o">.</span><span class="n">is_kronecker_product</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_quantum_operator</span><span class="p">:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="n">lhs</span> <span class="o">=</span> <span class="n">evaluate_kronright</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="c1"># Combine two Kronecker products, (A ⊗ B) ⊗ (C ⊗ D) = (A ⊗ B ⊗ C ⊗ D)</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="k">elif</span> <span class="n">lhs</span><span class="o">.</span><span class="n">is_kronecker_product</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">lhs</span> <span class="o">=</span> <span class="n">evaluate_kronjoin</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="k">return</span> <span class="n">lhs</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.evaluate_kronjoin" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_kronjoin</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker
product.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="k">def</span> <span class="nf">evaluate_kronjoin</span><span class="p">(</span><span class="n">lhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    product.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">is_kronecker_product</span> <span class="ow">or</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">):</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Only defined for LHS and RHS both Kronecker product.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">lhs</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">rhs</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_kron</span><span class="p">(</span><span class="n">Expression</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">term</span><span class="p">))</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.evaluate_kronleft" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_kronleft</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Left associativity of the Kronecker product.</p>
<p>Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker product.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="k">def</span> <span class="nf">evaluate_kronleft</span><span class="p">(</span><span class="n">lhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Left associativity of the Kronecker product.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker product.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">is_quantum_operator</span> <span class="ow">or</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">):</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Only defined for a quantum operator and a Kronecker product.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">args</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="c1"># Using a insertion-sort-like to add the LHS term in the the RHS product.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rhs_arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="k">if</span> <span class="n">rhs_arg</span><span class="o">.</span><span class="n">subspace</span> <span class="o">==</span> <span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_kronop</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs_arg</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_one</span><span class="p">:</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">result</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="k">break</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="k">if</span> <span class="n">rhs_arg</span><span class="o">.</span><span class="n">subspace</span> <span class="o">&gt;</span> <span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span> <span class="ow">or</span> <span class="n">rhs_arg</span><span class="o">.</span><span class="n">subspace</span><span class="o">.</span><span class="n">overlap_with</span><span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span><span class="p">):</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">lhs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="k">break</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">Expression</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.evaluate_kronop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_kronop</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate the Kronecker product between two quantum operators.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="k">def</span> <span class="nf">evaluate_kronop</span><span class="p">(</span><span class="n">lhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate the Kronecker product between two quantum operators.&quot;&quot;&quot;</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">is_quantum_operator</span> <span class="ow">or</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_quantum_operator</span><span class="p">):</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Operation only valid for LHS and RHS both quantum operators.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="c1"># Multiplication of unitary Hermitian operators acting on the the same subspace.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="k">if</span> <span class="n">lhs</span> <span class="o">==</span> <span class="n">rhs</span> <span class="ow">and</span> <span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_hermitian&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_unitary&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="c1"># General multiplications of operators acting on the same subspace.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span> <span class="o">==</span> <span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span><span class="p">:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_projector&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_projector&quot;</span><span class="p">):</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="k">return</span> <span class="n">lhs</span> <span class="k">if</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="n">Expression</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="k">if</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_function</span> <span class="ow">and</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_function</span> <span class="ow">and</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;join&quot;</span><span class="p">):</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;join&quot;</span><span class="p">)(</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dagger&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="n">rhs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dagger&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>            <span class="p">)</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>            <span class="k">return</span> <span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                <span class="n">res</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">is_zero</span> <span class="ow">or</span> <span class="n">res</span><span class="o">.</span><span class="n">is_one</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="k">else</span> <span class="n">Expression</span><span class="o">.</span><span class="n">quantum_operator</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">lhs</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>            <span class="p">)</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="c1"># Simplify the multiplication of unitary Hermitian operators with fractional</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="c1"># power, e.g., `√X() * √X() == X()`.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>            <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_power</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="ow">and</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_power</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="ow">and</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># both are the same operator</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_hermitian&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_unitary&quot;</span><span class="p">))</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="p">):</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="k">return</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>    <span class="c1"># Order the operators by subspace.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="k">if</span> <span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span> <span class="ow">or</span> <span class="n">lhs</span><span class="o">.</span><span class="n">subspace</span><span class="o">.</span><span class="n">overlap_with</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>    <span class="p">):</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">lhs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.evaluate_kronright" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_kronright</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Right associativity of the Kronecker product.</p>
<p>Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker product.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="k">def</span> <span class="nf">evaluate_kronright</span><span class="p">(</span><span class="n">lhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Expression</span><span class="p">:</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Right associativity of the Kronecker product.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">    Evaluate the Kronecker product between a LHS=quantum operators and a RHS=Kronecker product.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lhs</span><span class="o">.</span><span class="n">is_kronecker_product</span> <span class="ow">or</span> <span class="n">rhs</span><span class="o">.</span><span class="n">is_quantum_operator</span><span class="p">):</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Only defined for a Kronecker product and a quantum operator.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">args</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="c1"># Using a insertion-sort-like to add the RHS term in the the LHS product.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span> <span class="o">==</span> <span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_kronop</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rhs</span><span class="p">)</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_one</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">result</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">result</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="k">break</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span> <span class="ow">or</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subspace</span><span class="o">.</span><span class="n">overlap_with</span><span class="p">(</span><span class="n">rhs</span><span class="o">.</span><span class="n">subspace</span><span class="p">):</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[:</span><span class="n">ii</span><span class="p">],</span> <span class="n">rhs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">ii</span><span class="p">:])</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="k">break</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="k">return</span> <span class="n">Expression</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">Expression</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.visualize_expression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize_expression</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stringfy expressions.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="k">def</span> <span class="nf">visualize_expression</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stringfy expressions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_value</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_quantum_operator</span><span class="p">:</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="n">dag</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\u2020</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dagger&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="k">if</span> <span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_symbol</span> <span class="ow">or</span> <span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_function</span><span class="p">:</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">dag</span><span class="si">}{</span><span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_function</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;,</span><span class="se">\u2009</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">expr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_multiplication</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\u2009</span><span class="s2">*</span><span class="se">\u2009</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>        <span class="k">return</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;-1\.0(\s\*)?\s&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_kronecker_product</span><span class="p">:</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="k">return</span> <span class="n">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\u2009</span><span class="s2">*</span><span class="se">\u2009</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_addition</span><span class="p">:</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s2">&quot; + &quot;</span><span class="p">,</span> <span class="n">with_brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>        <span class="k">return</span> <span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s\+\s-(1\.0(\s\*)?\s)?&quot;</span><span class="p">,</span> <span class="s2">&quot; - &quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_power</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="k">return</span> <span class="n">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\u2009</span><span class="s2">^</span><span class="se">\u2009</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.visualize_sequence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">with_brackets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stringfy the arguments of an expression <code>expr</code> with the designed <code>operator</code>.</p>
<p>The <code>with_brackets</code> option wrap any argument that is either a multiplication or a sum.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="k">def</span> <span class="nf">visualize_sequence</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">Expression</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">with_brackets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stringfy the arguments of an expression `expr` with the designed `operator`.</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    The `with_brackets` option wrap any argument that is either a multiplication or a sum.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_value</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_symbol</span> <span class="ow">or</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">is_quantum_operator</span> <span class="ow">and</span> <span class="n">expr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">):</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Only a sequence of expressions is allowed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="k">if</span> <span class="n">with_brackets</span><span class="p">:</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">visualize_with_brackets</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">))</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>    <span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence2_expressions.core.expression.visualize_with_brackets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">visualize_with_brackets</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stringfy addition and multiplication expression surrounded by brackets.</p>

            <details class="quote">
              <summary>Source code in <code>qadence2_expressions/core/expression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="k">def</span> <span class="nf">visualize_with_brackets</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="n">Expression</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stringfy addition and multiplication expression surrounded by brackets.&quot;&quot;&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_multiplication</span> <span class="ow">or</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_addition</span><span class="p">:</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.action.view", "content.action.edit", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>